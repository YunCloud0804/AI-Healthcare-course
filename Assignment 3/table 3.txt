SELECT
    FLOOR(EXTRACT(YEAR FROM AGE(ADMISSIONS.ADMITTIME, PATIENTS.DOB)) / 10) * 10 AS Age_Group,
    AVG(EXTRACT(DAY FROM (ADMISSIONS.DISCHTIME - ADMISSIONS.ADMITTIME))) AS Avg_LOS,
    STDDEV(EXTRACT(DAY FROM (ADMISSIONS.DISCHTIME - ADMISSIONS.ADMITTIME))) AS Mean_LOS,
    MAX(EXTRACT(DAY FROM (ADMISSIONS.DISCHTIME - ADMISSIONS.ADMITTIME))) AS Max_LOS,
    COUNT(DIAGNOSES_ICD.SUBJECT_ID) AS Patient_Count
FROM
    DIAGNOSES_ICD
JOIN
    ADMISSIONS ON DIAGNOSES_ICD.HADM_ID = ADMISSIONS.HADM_ID
JOIN
    PATIENTS ON DIAGNOSES_ICD.SUBJECT_ID = PATIENTS.SUBJECT_ID
WHERE
    DIAGNOSES_ICD.ICD9_CODE LIKE '584%'  -- Filter for acute kidney failure diagnosis
    AND ADMISSIONS.DISCHTIME IS NOT NULL  -- Ensure the patient has been discharged
GROUP BY
    Age_Group
ORDER BY
    Age_Group;
