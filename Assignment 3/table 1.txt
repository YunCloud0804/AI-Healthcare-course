SELECT
    FLOOR(EXTRACT(YEAR FROM AGE(ADMISSIONS.ADMITTIME, PATIENTS.DOB)) / 10) * 10 AS Age_Group,
    COUNT(CASE WHEN PATIENTS.GENDER = 'M' THEN 1 END) AS Male_Count,
    COUNT(CASE WHEN PATIENTS.GENDER = 'F' THEN 1 END) AS Female_Count
FROM
    DIAGNOSES_ICD
JOIN
    ADMISSIONS ON DIAGNOSES_ICD.HADM_ID = ADMISSIONS.HADM_ID
JOIN
    PATIENTS ON DIAGNOSES_ICD.SUBJECT_ID = PATIENTS.SUBJECT_ID
WHERE
    DIAGNOSES_ICD.ICD9_CODE LIKE '584%'  -- Filtering for acute kidney failure diagnosis
GROUP BY
    ROLLUP(Age_Group)
ORDER BY
    Age_Group;